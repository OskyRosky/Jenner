---
title: "Tesis sobre las mezclas asf√°lticas."
author: "Jenner Picado"
output:
  html_document:
    toc: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)

library(tidyverse)
library(skimr)
library(readxl)
library(janitor)
library(skimr)
library(corrplot)
library(lme4)
library(lmerTest)
library(emmeans)
library(performance)
library(car)
library(knitr)
library(kableExtra)
library(ggplot2)
library(tidyr)


# Objetivo 1: hoja "dataob1"
# Salta la fila 1 (t√≠tulos de bloque) y usa la fila 2 como encabezado
datos_obj1_raw <- read_excel(
  "data.xlsx",
  sheet     = "dataob1",
  skip      = 1,   # üëà ahora la fila con "Mezcla N¬∞  Bloque N¬∞  Gbs-Gmm  ..." ser√° el header
  col_names = TRUE
) |>
  clean_names()

# Objetivo 2: hoja "dataob2"
datos_obj2_raw <- read_excel(
  "data.xlsx",
  sheet     = "dataob2",
  skip      = 1,   # üëà usa la fila con "Mezcla N¬∞, Bloque N¬∞, Gbs-Gmm, ..., PDF-..., PVM-..." como header
  col_names = TRUE
) |>
  clean_names()

```

<style>
table {
background-color:#FFFFFF;
}
</style>

<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: darkblue;
}
</style>

<button onclick="document.body.scrollTop = document.documentElement.scrollTop = 0;" style="
    position: fixed;
    bottom: 5px;
    right: 40px;
    text-align: center;
    cursor: pointer;
    outline: none;
    color: #fff;
    background-color: #0A71A0;
    border: none;
    border-radius: 15px;
    
">Ir arriba</button>


# {.tabset .tabset-fade .tabset-pills}


**Tesis final de graduaci√≥n.**

## 1. Intro.  {.tabset .tabset-fade .tabset-pills}

Las mezclas asf√°lticas utilizadas en pavimentos deben cumplir simult√°neamente dos condiciones fundamentales: poseer un contenido adecuado de vac√≠os de aire y desarrollar una resistencia suficiente a la fatiga frente a cargas repetidas. Un porcentaje de vac√≠os demasiado bajo favorece el ahuellamiento y la p√©rdida de estabilidad; un porcentaje demasiado alto acelera la penetraci√≥n de agua y aire, y por tanto el deterioro de la mezcla. De forma complementaria, la respuesta a fatiga condiciona la vida √∫til del pavimento ante miles o millones de aplicaciones de carga.

En este trabajo se estudian mezclas compactadas con el Compactador de Cortante ASC bajo la norma ASTM D7981, a partir de las cuales se obtienen bloques prism√°ticos que luego se cortan para producir vigas de ensayo. Tanto los bloques como las vigas se someten a la prueba de gravedad aparente del agregado grueso (Gbs), a partir de la cual se calcula la gravedad espec√≠fica de la mezcla (Gmb) y finalmente el porcentaje de vac√≠os de aire (% vac√≠os). Posteriormente, las vigas se ensayan en flexo-tracci√≥n din√°mica seg√∫n AASHTO T321, obteniendo el n√∫mero de ciclos a falla para diferentes niveles de deformaci√≥n y tama√±os m√°ximos nominales (TMN).

El an√°lisis estad√≠stico se organiza en dos objetivos complementarios:
	‚Ä¢	Objetivo 1. Analizar la distribuci√≥n de los % de vac√≠os de aire en los bloques prism√°ticos compactados y en las vigas obtenidas del ASC, identificando qu√© parte de la variabilidad se asocia al dise√±o de mezcla, al proceso de compactaci√≥n del bloque y al corte/operario de las vigas. Para ello se plantear√° un ANOVA jer√°rquico / modelo mixto, y posteriormente se ajustar√° un modelo de regresi√≥n que relacione los % de vac√≠os con las propiedades volum√©tricas de la mezcla, buscando una primera ecuaci√≥n que describa su comportamiento.
	‚Ä¢	Objetivo 2. Identificar las propiedades m√°s significativas de la mezcla asf√°ltica que inciden en los ciclos de fatiga obtenidos mediante el ensayo de flexo-tracci√≥n din√°mica AASHTO T321, considerando los niveles de deformaci√≥n de 400 y 600 microdeformaciones y los TMN de 12,5 mm y 19 mm. Se ajustar√°n modelos de regresi√≥n para cuatro casos (combinaciones TMN‚Äìdeformaci√≥n) con el fin de obtener una primera versi√≥n de un modelo predictivo de ciclos de fatiga en funci√≥n de las propiedades volum√©tricas, incluyendo el an√°lisis de rigidez inicial, rigidez final y n√∫mero de ciclos a falla.

Con este enfoque, el trabajo no solo cuantifica la variabilidad de los vac√≠os de aire en las distintas etapas del proceso (mezcla‚Äìbloque‚Äìviga), sino que tambi√©n propone ecuaciones iniciales para relacionar las propiedades volum√©tricas con el desempe√±o mec√°nico a fatiga, aportando criterios objetivos para el dise√±o y control de mezclas asf√°lticas.

## 2. Datos.  {.tabset .tabset-fade .tabset-pills}

### Ingesta de datos.

La base de datos utilizada en este estudio proviene de un archivo √∫nico en formato Excel (data.xlsx) que contiene dos hojas de trabajo:

	‚Ä¢	dataob1: informaci√≥n correspondiente al Objetivo 1, donde se registran los resultados de la prueba de Gbs, el c√°lculo de % de vac√≠os y las propiedades volum√©tricas de cada mezcla.
	
	‚Ä¢	dataob2: informaci√≥n del Objetivo 2, que incluye los resultados del ensayo de fatiga AASHTO T321, adem√°s de las mismas propiedades volum√©tricas utilizadas para el an√°lisis.

En ambas hojas, la primera fila contiene encabezados generales (por ejemplo: PRUEBA DE Gbs Y %Vac√≠os, PROPIEDADES VOLUM√âTRICAS MAC). Por esta raz√≥n, la ingesta se realiza omitiendo esa fila inicial para que R utilice como encabezado la segunda fila, donde se encuentran los nombres reales de las variables.

Los nombres de columnas se estandarizan mediante clean_names() para facilitar la manipulaci√≥n posterior en el an√°lisis estad√≠stico.


### Datos de origen.

A continuaci√≥n, se muestran las primeras filas de cada dataset tal como fueron importadas a R despu√©s del proceso de limpieza de nombres. Estos datos representan:

Para Objetivo 1:

	‚Ä¢	Identificaci√≥n de mezcla (mezcla_n)
	‚Ä¢	Identificaci√≥n del bloque (bloque_n)
	‚Ä¢	Variables de la prueba de Gbs (prefijo Gbs-)
	‚Ä¢	C√°lculo del % de vac√≠os
	‚Ä¢	Propiedades volum√©tricas de la mezcla (prefijo PVM-)
	
Para Objetivo 2:
	
‚Ä¢	Mismas variables de Gbs y % de vac√≠os
‚Ä¢	Resultados del ensayo de fatiga (prefijo PDF-)
‚Ä¢	Propiedades volum√©tricas (prefijo PVM-)

Estos datos constituyen la base para el an√°lisis descriptivo, el ANOVA jer√°rquico del Objetivo 1 y los modelos de regresi√≥n para ambos objetivos.


```{r}
head(datos_obj1_raw, 10) |> kable() |> kable_styling(full_width = FALSE)

```

```{r}
head(datos_obj2_raw, 10) |> kable() |> kable_styling(full_width = FALSE)
```


### Listado de variables por objetivo.

A continuaci√≥n se presentan todas las variables disponibles en cada conjunto de datos, de acuerdo con su organizaci√≥n y finalidad dentro de la tesis. Esta revisi√≥n facilita comprender qu√© informaci√≥n se analiza en cada objetivo y permite verificar la consistencia de nombres antes de aplicar los modelos estad√≠sticos.

Objetivo 1 ‚Äì Variables disponibles

Incluye:

‚Ä¢	Identificaci√≥n de mezcla y bloque.
‚Ä¢	Variables derivadas de la prueba de Gbs (prefijo gbs_).
‚Ä¢	Porcentaje de vac√≠os.
‚Ä¢	Propiedades volum√©tricas de la mezcla (prefijo pvm_).


```{r}
names(datos_obj1_raw) |> 
  as.data.frame() |> 
  kable(col.names = "Variables ‚Äì Objetivo 1") |> 
  kable_styling(full_width = FALSE)
```

Objetivo 2 ‚Äì Variables disponibles

Incluye:

‚Ä¢	Identificaci√≥n de mezcla y bloque.
‚Ä¢	Variables de la prueba de Gbs.
‚Ä¢	Variables del ensayo de fatiga (prefijo pdf_).
‚Ä¢	Propiedades volum√©tricas de la mezcla (prefijo pvm_).


```{r}
names(datos_obj2_raw) |> 
  as.data.frame() |> 
  kable(col.names = "Variables ‚Äì Objetivo 2") |> 
  kable_styling(full_width = FALSE)
```


### Calidad de los datos.

Antes de proceder con los an√°lisis estad√≠sticos, se verific√≥ la consistencia y validez general de las bases de datos.  
Dado que los valores provienen directamente del proceso experimental, no se aplic√≥ limpieza activa ni modificaci√≥n de observaciones.  
√önicamente se evaluaron tres aspectos fundamentales:

1. **Valores faltantes (NA).**  
   Se revis√≥ la presencia de datos ausentes en las variables utilizadas en los modelos.  
   El an√°lisis mostr√≥ que no existen valores faltantes en las variables relevantes para los Objetivos 1 y 2.

2. **Consistencia del dise√±o jer√°rquico.**  
   Se confirm√≥ la estructura esperada del experimento:  
   - cada mezcla cuenta con exactamente dos bloques (A y B),  
   - cada bloque contiene cinco vigas,  
   - totalizando 240 observaciones completas.  
   Esta verificaci√≥n garantiza que el dise√±o est√° balanceado, condici√≥n favorable para el ANOVA jer√°rquico.

3. **Revisi√≥n de rangos f√≠sicos.**  
   Se evalu√≥ que los valores de % de vac√≠os, Gmm, Gmb, TMN y gradaciones se encuentran dentro de rangos f√≠sicamente plausibles.  
   No se detectaron valores imposibles ni inconsistencias experimentales.

Con estas revisiones, se concluye que las bases de datos poseen calidad suficiente para continuar con las etapas de an√°lisis descriptivo y modelado estad√≠stico.

#### 1. Revisi√≥n de valores faltantes (NA).

```{r}
colSums(is.na(datos_obj1_raw))
colSums(is.na(datos_obj2_raw))
```

El an√°lisis inicial de la calidad del dato, centrado en la detecci√≥n de valores faltantes (NA) dentro de ambas bases de informaci√≥n, revela un panorama muy favorable para el desarrollo de los modelos estad√≠sticos posteriores. En el caso del conjunto de datos correspondiente al Objetivo 1, que contiene la informaci√≥n asociada a la prueba de gravedad aparente del agregado grueso (Gbs) y al c√°lculo del porcentaje de vac√≠os, no se identificaron valores faltantes en ninguna de las variables. Esto implica que las observaciones est√°n completas y que todas las columnas cuentan con informaci√≥n v√°lida para cada registro. La ausencia total de NA permite avanzar con plena confianza en los an√°lisis de variabilidad, el ANOVA jer√°rquico y los modelos de regresi√≥n asociados a este primer objetivo, ya que no ser√° necesario aplicar procedimientos de imputaci√≥n ni descartar filas, lo que fortalece la integridad del an√°lisis.

En contraste, el conjunto de datos correspondiente al Objetivo 2, que incorpora las mediciones derivadas de los ensayos de fatiga bajo la norma AASHTO T321, s√≠ presenta valores faltantes en varias variables clave del ensayo, tales como deformaci√≥n, n√∫mero de ciclos, rigideces inicial y final, energ√≠a disipada y esfuerzo inicial, entre otras. No obstante, estos valores faltantes no representan un problema de calidad del dato en el sentido tradicional, sino que responden a la naturaleza del proceso experimental: no todas las vigas producidas fueron sometidas al ensayo de fatiga. Es decir, la ausencia de informaci√≥n en estas columnas refleja que dichos espec√≠menes simplemente no fueron ensayados, y no que exista un error o p√©rdida de datos. Por esa raz√≥n, estos NA no deben ser imputados ni corregidos artificialmente, sino manejados mediante una selecci√≥n apropiada de los registros que s√≠ cuentan con informaci√≥n completa para la elaboraci√≥n de los modelos predictivos del segundo objetivo.

En s√≠ntesis, la presencia de NA no compromete el desarrollo de la tesis. Para el Objetivo 1, los datos est√°n completos y permiten un an√°lisis estad√≠stico directo y robusto. Para el Objetivo 2, los valores faltantes corresponden a vigas no ensayadas, por lo que el an√°lisis se realizar√° √∫nicamente con las observaciones que s√≠ disponen de los resultados del ensayo T321. De esta manera, la estructura del an√°lisis se mantiene s√≥lida y metodol√≥gicamente adecuada, sin que los valores faltantes representen un obst√°culo para alcanzar los objetivos planteados.

#### 2. Consistencia del dise√±o jer√°rquico: Mezcla ‚Üí Bloque ‚Üí Viga

```{r}
datos_obj1_raw |>
  count(mezcla_n, bloque_n) |>
  count(n)
```

```{r}
datos_obj1_raw |>
  count(mezcla_n) |> 
  count(n)
```

La verificaci√≥n de la estructura jer√°rquica en el conjunto de datos del Objetivo 1 permite confirmar que el dise√±o experimental mantiene la coherencia esperada entre sus niveles: cada mezcla corresponde a varios bloques compactados, y cada bloque origina un conjunto de vigas provenientes del proceso de corte. Al analizar simult√°neamente las variables mezcla_n y bloque_n, se observa que existen cinco combinaciones √∫nicas mezcla‚Äìbloque, produciendo un total de 48 espec√≠menes. Esto indica que, en promedio, cada combinaci√≥n mezcla‚Äìbloque genera varias vigas, tal como lo exige el dise√±o jer√°rquico del Compactador de Cortante ASC bajo la norma ASTM D7981.

Cuando se analiza √∫nicamente la variable mezcla_n, se identifican diez mezclas diferentes con un total de 24 bloques, lo cual implica que algunas mezclas poseen m√°s bloques que otras. Esta variaci√≥n es habitual en estudios experimentales donde no todas las mezclas se compactan con igual intensidad o disponibilidad. Lo relevante es que la estructura mantiene su coherencia l√≥gica: las vigas siempre dependen de un bloque, y los bloques siempre dependen de una mezcla, sin que se encuentren inconsistencias como c√≥digos duplicados, bloques sin mezcla asociada, o vigas asignadas a combinaciones inexistentes. Esta consistencia es fundamental porque valida la pertinencia del an√°lisis mediante modelos jer√°rquicos o mixtos, en los cuales los efectos del bloque y la mezcla se modelan de manera estructurada y conforme a la realidad experimental.

Respecto al Objetivo 2, no se incluye esta revisi√≥n jer√°rquica porque la estructura del experimento es diferente. En las pruebas de fatiga (AASHTO T321), el nivel jer√°rquico relevante no es mezcla‚Äìbloque‚Äìviga, sino viga ensayada bajo diferentes condiciones mec√°nicas. En este caso, solo un subconjunto de las vigas provenientes del Objetivo 1 se somete al ensayo de fatiga, y el inter√©s del an√°lisis ya no recae en la variabilidad introducida por mezcla o bloque, sino en las propiedades volum√©tricas y en la respuesta mec√°nica bajo deformaciones controladas. El dise√±o del Objetivo 2 no es jer√°rquico, sino m√°s bien condicional: √∫nicamente se analizan las vigas para las cuales se cuenta con resultados completos del ensayo din√°mico. Por este motivo, la revisi√≥n de consistencia jer√°rquica es innecesaria para esta fase.

En s√≠ntesis, el an√°lisis del dise√±o jer√°rquico confirma que los datos del Objetivo 1 poseen una estructura completa y coherente que permitir√° ajustar modelos estad√≠sticos robustos. Mientras tanto, la naturaleza del Objetivo 2 se centra en el desempe√±o mec√°nico de las vigas ensayadas, donde la jerarqu√≠a experimental original ya no desempe√±a un papel anal√≠tico directo.


#### 3. Rangos f√≠sicos de las variables principales


```{r}
summary(datos_obj1_raw$gbs_percent_vacios_7_1)
summary(datos_obj1_raw$gbs_gmm)
summary(datos_obj1_raw$gbs_gmb)
table(datos_obj1_raw$gbs_tmn_mm)
```

La revisi√≥n de los rangos f√≠sicos en el Objetivo 1 permite confirmar que las variables cr√≠ticas del proceso de compactaci√≥n y caracterizaci√≥n volum√©trica presentan valores coherentes con los reportados en la literatura y con lo que se espera en mezclas asf√°lticas fabricadas bajo la norma ASTM D7981.

Los porcentajes de vac√≠os de aire (Gbs-%Vac√≠os) oscilan entre aproximadamente 5,3 % y 12,4 %. Este rango es consistente con los procesos de compactaci√≥n del ASC, donde pueden presentarse variaciones asociadas al operador, al bloque de origen o a la propia mezcla. La mediana cercana al 6,7 % y el sesgo hacia valores ligeramente superiores reflejan la variabilidad natural del ensayo, sin evidencias de valores at√≠picos que sugieran errores de medici√≥n o de registro.

La gravedad espec√≠fica m√°xima te√≥rica (Gbs-Gmm) muestra valores entre 2,363 y 2,416, totalmente razonables para mezclas densas con agregados de tipo bas√°ltico o granito. Del mismo modo, la gravedad espec√≠fica de la mezcla compactada (Gbs-Gmb) presenta un rango bien delimitado entre aproximadamente 2,10 y 2,27, lo cual es plenamente coherente con el nivel de compactaci√≥n y con los vac√≠os de aire reflejados en la tabla.

Finalmente, la variable TMN presenta √∫nicamente dos valores esperados: 12,5 mm y 19 mm, lo que confirma que los espec√≠menes provienen de dos dise√±os de mezcla distintos, tal como lo indicaba la planificaci√≥n experimental.

En conjunto, estos resultados muestran que los rangos f√≠sicos del Objetivo 1 son l√≥gicos, no presentan anormalidades y garantizan que los an√°lisis estad√≠sticos posteriores no se ver√°n afectados por inconsistencias num√©ricas, valores imposibles o errores de medici√≥n.

¬øPor qu√© este an√°lisis no se repite en el Objetivo 2?

La revisi√≥n detallada de rangos f√≠sicos se realiz√≥ √∫nicamente para el Objetivo 1 porque all√≠ se estudian variables fundamentales del proceso de compactaci√≥n, fabricaci√≥n de bloques y producci√≥n de vigas, es decir, variables que representan directamente la calidad volum√©trica de la mezcla. Estas variables requieren verificaci√≥n rigurosa, ya que constituyen la base de los modelos jer√°rquicos y la estructura experimental del estudio.

En cambio, el Objetivo 2 se centra en un subconjunto de las vigas del Objetivo 1, pero ya no para evaluar su fabricaci√≥n, sino para analizar su comportamiento mec√°nico bajo fatiga. Las variables del Objetivo 2 (rigidez inicial, energ√≠a disipada, ciclos a falla, etc.) dependen directamente del ensayo din√°mico AASHTO T321, el cual genera valores que ya est√°n acotados por el propio procedimiento del equipo. Adem√°s, en esta fase lo m√°s relevante no es verificar rangos f√≠sicos, sino evaluar relaciones funcionales entre propiedades volum√©tricas y desempe√±o mec√°nico.

Adicionalmente, el Objetivo 2 no requiere validar jerarqu√≠as (mezcla‚Äìbloque‚Äìviga), porque el ensayo de fatiga rompe esa estructura: solo se ensayan vigas individuales bajo condiciones controladas, y el an√°lisis consiste en modelos de regresi√≥n m√°s que en estructuras jer√°rquicas.

En resumen:
	‚Ä¢	El Objetivo 1 analiza la variabilidad del proceso de producci√≥n de vigas, donde es crucial verificar rangos f√≠sicos, jerarqu√≠as y consistencia.
	‚Ä¢	El Objetivo 2 analiza √∫nicamente el desempe√±o de vigas individuales, donde el inter√©s es la relaci√≥n entre variables, no la validaci√≥n del proceso de fabricaci√≥n.

Por eso el an√°lisis de rangos f√≠sicos es indispensable en el Objetivo 1, pero innecesario en el Objetivo 2.

### Estad√≠sticas descsriptivas. 

#### dataob1

```{r}
summary(select(datos_obj1_raw, where(is.numeric)))
```


```{r}
datos_obj1_raw |> 
  count(mezcla_n) |> 
  mutate(pct = n / sum(n) * 100)

datos_obj1_raw |> 
  count(bloque_n) |> 
  mutate(pct = n / sum(n) * 100)
```

```{r}


num_obj1 <- datos_obj1_raw |> select(where(is.numeric))

corr_obj1 <- cor(num_obj1, use = "pairwise.complete.obs")

corrplot(corr_obj1, method = "color", tl.cex = 0.6)
```


```{r}
datos_obj1_raw |> 
  select(where(is.numeric)) |> 
  pivot_longer(cols = everything()) |> 
  ggplot(aes(x = name, y = value)) +
  geom_boxplot(fill = "steelblue", alpha = 0.7) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

El an√°lisis descriptivo del conjunto de datos correspondiente al Objetivo 1 muestra un dise√±o completamente balanceado, tanto en las mezclas como en los bloques. Cada una de las 24 mezclas presenta exactamente diez observaciones, lo cual facilita los an√°lisis posteriores y garantiza que los resultados no se vean afectados por desbalances estructurales. Asimismo, los 48 bloques (dos por mezcla) tambi√©n cuentan con cinco vigas cada uno, confirmando que la estructura jer√°rquica Mezcla ‚Üí Bloque ‚Üí Viga est√° representada de manera uniforme.

En t√©rminos de las variables num√©ricas, la inspecci√≥n de sus estad√≠sticas descriptivas revela que los rangos son coherentes con valores f√≠sicamente posibles para mezclas asf√°lticas. El porcentaje de vac√≠os (%Vac√≠os) se concentra en torno al 7 %, sin valores extremos que sugieran errores de medici√≥n o digitaci√≥n. Las variables Gmm y Gmb tambi√©n muestran rangos estrechos, compatibles con materiales de densidad adecuada. No se observan valores at√≠picos severos en estas variables principales.

El an√°lisis de correlaci√≥n evidencia relaciones fuertes entre varias propiedades volum√©tricas. Esto es esperable, ya que par√°metros como VMA, VFA, Polvo-Asfalto y % pasando tamices forman parte de la misma estructura f√≠sico-granulom√©trica. Esta correlaci√≥n elevada anticipa un riesgo de multicolinealidad en los modelos de regresi√≥n del Objetivo 1, lo que ser√° importante manejar mediante selecci√≥n cuidadosa de variables o diagn√≥sticos adicionales (como el VIF). No obstante, estas correlaciones no afectan el an√°lisis del ANOVA jer√°rquico, ya que dicho modelo eval√∫a fuentes de variaci√≥n y no relaciones entre predictores.

Finalmente, los boxplots muestran distribuciones razonables sin presencia de valores aberrantes. Algunas variables granulom√©tricas presentan baja variabilidad, coherente con dise√±os de mezcla controlados, mientras que otras, como las propiedades derivadas de Gbs, exhiben una variaci√≥n moderada pero esperada seg√∫n el proceso de compactaci√≥n y corte.

En conjunto, los datos del Objetivo 1 presentan una calidad suficiente para continuar con los modelos jer√°rquicos y de regresi√≥n planificados. No se evidencian problemas de valores faltantes, inconsistencias jer√°rquicas o rangos f√≠sicos an√≥malos que comprometan los an√°lisis posteriores.


#### dataob2


```{r}
summary(select(datos_obj2_raw, where(is.numeric)))
```


```{r}
datos_obj2_raw |> 
  count(mezcla_n) |> 
  mutate(pct = n / sum(n) * 100)

datos_obj2_raw |> 
  count(bloque_n) |> 
  mutate(pct = n / sum(n) * 100)
```

```{r}
num_obj2 <- datos_obj2_raw |> select(where(is.numeric))

corr_obj2 <- cor(num_obj2, use = "pairwise.complete.obs")

corrplot(corr_obj2, method = "color", tl.cex = 0.55)
```

```{r}
datos_obj2_raw |> 
  select(where(is.numeric)) |> 
  pivot_longer(cols = everything()) |> 
  ggplot(aes(x = name, y = value)) +
  geom_boxplot(fill = "darkgreen", alpha = 0.7) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

```{r}
datos_obj2_raw |> 
  select(where(is.numeric)) |> 
  select(-pdf_numero_de_ciclos) |>   # ‚¨ÖÔ∏è excluir la columna grande
  pivot_longer(cols = everything()) |> 
  ggplot(aes(x = name, y = value)) +
  geom_boxplot(fill = "darkgreen", alpha = 0.7) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

Resumen descriptivo del Objetivo 2

El an√°lisis descriptivo del conjunto de datos correspondiente al Objetivo 2 confirma que el dise√±o experimental conserva la misma estructura jer√°rquica utilizada en el Objetivo 1. Las 24 mezclas analizadas contienen dos bloques por mezcla (A/B) y cinco vigas por bloque, manteniendo un esquema completamente balanceado de 10 observaciones por mezcla. Esta consistencia es relevante, ya que permite comparar resultados de fatiga sin introducir sesgos derivados del dise√±o o de la distribuci√≥n de muestras.

En cuanto a los par√°metros de compactaci√≥n (Gmm, Gmb, TMN, masa seca/sumergida/saturada) y las propiedades volum√©tricas (VMA, VFA, vac√≠os, relaci√≥n polvo-asfalto, gradaci√≥n), los rangos observados coinciden con los del Objetivo 1, lo cual es esperable porque ambos conjuntos provienen de los mismos bloques y vigas. Esto aporta estabilidad conceptual: cualquier diferencia entre Objetivo 1 y Objetivo 2 provendr√° del comportamiento mec√°nico de las vigas, no de variaciones en la compactaci√≥n o en la gradaci√≥n.

La mayor diferencia aparece en las variables propias del ensayo de fatiga seg√∫n AASHTO T321. Variables como la rigidez inicial, la rigidez final, la deformaci√≥n unitaria y la energ√≠a disipada presentan una dispersi√≥n significativamente mayor que las propiedades volum√©tricas. Sin embargo, la variable que condiciona la escala global es el n√∫mero de ciclos a falla, cuyos valores pueden alcanzar cientos de miles o m√°s. Este orden de magnitud genera que, en un boxplot general, el resto de variables num√©ricas quede visualmente comprimido. Por ese motivo se gener√≥ un segundo boxplot excluyendo esta variable, lo que permiti√≥ representar adecuadamente la variabilidad de los dem√°s par√°metros de fatiga.

Esta diferencia de escalas no solo afecta la visualizaci√≥n: tambi√©n tiene implicaciones metodol√≥gicas. En los modelos de regresi√≥n del Objetivo 2 ‚Äîque se ajustar√°n por separado para cada combinaci√≥n de TMN y nivel de deformaci√≥n‚Äî ser√° necesario considerar alg√∫n tipo de estandarizaci√≥n de variables (por ejemplo, normalizaci√≥n mediante media y desviaci√≥n est√°ndar) para evitar que las magnitudes absolutas condicionen la estimaci√≥n de coeficientes. La estandarizaci√≥n no altera las relaciones estad√≠sticas entre variables, pero mejora la estabilidad num√©rica de los modelos y facilita la interpretaci√≥n de la importancia relativa de cada propiedad volum√©trica.

El an√°lisis de correlaci√≥n muestra asociaciones internas coherentes: las variables de fatiga mantienen relaciones moderadas entre s√≠, lo cual es consistente con el comportamiento mec√°nico esperado, mientras que las propiedades volum√©tricas exhiben su patr√≥n cl√°sico de dependencia interna (por razones geom√©tricas y f√≠sicas). Estas correlaciones no son lo suficientemente altas como para anticipar problemas severos de multicolinealidad, aunque s√≠ justifican una selecci√≥n cuidadosa de predictores para evitar redundancias en la regresi√≥n.

En conjunto, el dataset del Objetivo 2 se presenta estable, sin valores fuera de rango f√≠sico y sin problemas de balance. El √∫nico aspecto que requiere tratamiento especial es la diferencia extrema de escalas entre las variables de fatiga, particularmente el n√∫mero de ciclos, lo que deber√° considerarse al momento de construir los modelos predictivos de desempe√±o.

## 3.  Objetivo 1: An√°lisis de la variabilidad del % de vac√≠os. {.tabset .tabset-fade .tabset-pills}


El Objetivo 1 se centra en estudiar la variabilidad del porcentaje de vac√≠os de aire medido en las vigas obtenidas a partir del Compactador de Cortante ASC. Esta variable, registrada como gbs_percent_vacios_7_1, constituye la respuesta principal del an√°lisis y refleja el desempe√±o volum√©trico resultante del proceso de compactaci√≥n y corte de los bloques prism√°ticos producidos bajo la norma ASTM D7981.

El dise√±o experimental posee una estructura jer√°rquica claramente definida: para cada una de las 24 mezclas evaluadas se producen dos bloques (A y B), y de cada bloque se extraen cuatro vigas de ensayo. Esto genera tres niveles de variabilidad potencial:
	1.	Variabilidad entre mezclas (diferencias en el dise√±o de la mezcla asf√°ltica).
	2.	Variabilidad entre bloques dentro de mezcla (diferencias en el proceso de compactaci√≥n).
	3.	Variabilidad entre vigas dentro de bloque (diferencias en el proceso de corte u operario).

Esta estructura requiere un modelo estad√≠stico capaz de descomponer la variaci√≥n en cada uno de estos niveles. Por ello se utiliza un modelo mixto jer√°rquico, en el cual la mezcla se trata como efecto fijo (porque corresponden a dise√±os espec√≠ficos) y los bloques y vigas como efectos aleatorios, anidados dentro de su nivel superior. El modelo general adoptado es:

\[
\text{Vac√≠os}_{ijk}
= \mu 
+ \alpha_i
+ b_{j(i)}
+ c_{k(ij)}
+ \varepsilon_{ijk},
\]

donde:

\[
\begin{aligned}
\mu              &:\ \text{media global}, \\
\alpha_i         &:\ \text{efecto fijo de la mezcla } i, \\
b_{j(i)}         &:\ \text{efecto aleatorio del bloque } j \text{ dentro de la mezcla } i, \\
c_{k(ij)}        &:\ \text{efecto aleatorio de la viga } k \text{ dentro del bloque } j \text{ y mezcla } i, \\
\varepsilon_{ijk} &:\ \text{error residual}.
\end{aligned}
\]

Este modelo permite cuantificar la proporci√≥n de variabilidad atribuible a cada nivel del proceso (dise√±o ‚Üí compactaci√≥n ‚Üí corte), lo cual constituye la primera parte del an√°lisis solicitado.

La segunda parte del Objetivo 1 consiste en identificar cu√°les propiedades volum√©tricas explican mejor el porcentaje de vac√≠os, con el fin de obtener una primera ecuaci√≥n explicativa del comportamiento de la mezcla. Para ello se consideran como posibles predictores las variables volum√©tricas y de gradaci√≥n disponibles en el dataset, tales como:

‚Ä¢	Gmm, Gmb, VMA (%), VFA (%), Vac√≠os PV, Gbs

‚Ä¢	Contenido de asfalto efectivo y sobre MAC

‚Ä¢	Relaci√≥n polvo/asfalto

‚Ä¢	Porcentajes pasando (1/2‚Äù, #4, #8, #200)

‚Ä¢	TMN (mm)

Estas variables se emplean dentro de un modelo de regresi√≥n lineal m√∫ltiple de la forma:


\[
\widehat{\text{Vac√≠os}}
= \beta_0
+ \beta_1 X_1
+ \beta_2 X_2
+ \cdots
+ \beta_p X_p,
\]

donde X_1, \dots, X_p representan las propiedades volum√©tricas seleccionadas.
Previo al ajuste del modelo se eval√∫a la colinealidad entre predictores mediante matrices de correlaci√≥n y factores de inflaci√≥n de la varianza (VIF), con el fin de evitar redundancias y garantizar que la ecuaci√≥n estimada posea coherencia f√≠sica y estad√≠stica.

En resumen, el an√°lisis del Objetivo 1 se desarrolla en dos etapas complementarias:

1.	Modelo mixto jer√°rquico ‚Üí cuantificar la variabilidad del % de vac√≠os seg√∫n mezcla, bloque y viga.

2.	Modelo de regresi√≥n volum√©trica ‚Üí identificar las propiedades de la mezcla que explican el % de vac√≠os y obtener una ecuaci√≥n explicativa inicial.

Ambos enfoques permiten caracterizar el comportamiento volum√©trico de las mezclas asf√°lticas desde una perspectiva integradora: variabilidad estructural y relaciones f√≠sico‚Äìvolum√©tricas.






### 3.1 Exploraci√≥n inicial del % de vac√≠os



Antes de ajustar el modelo jer√°rquico, es necesario describir el comportamiento general de la variable respuesta (% de vac√≠os) y explorar visualmente su variaci√≥n a trav√©s de los distintos niveles del dise√±o experimental. Esta exploraci√≥n permite identificar patrones preliminares, posibles outliers y verificar si la distribuci√≥n es compatible con los supuestos del modelo mixto.

Los an√°lisis incluidos en esta secci√≥n son:

- Estad√≠sticas descriptivas del % de vac√≠os.  
- Boxplots por mezcla, para observar diferencias globales entre dise√±os.  
- Boxplots por bloque dentro de cada mezcla, con el fin de inspeccionar posibles efectos de compactaci√≥n.  
- Histograma y curvas de densidad para evaluar la distribuci√≥n general.  
- Gr√°fico Q‚ÄìQ para una inspecci√≥n b√°sica de la normalidad de los datos.

Estos resultados permiten contextualizar la variabilidad observada y preparar el terreno para la partici√≥n formal de la varianza en la secci√≥n siguiente.



**Estad√≠sticas descriptivas**


```{r}
summary(datos_obj1_raw$gbs_percent_vacios_7_1)
```


**Boxplot por mezcla**


```{r}
ggplot(datos_obj1_raw, aes(x = factor(mezcla_n), y = gbs_percent_vacios_7_1)) +
  geom_boxplot(fill = "steelblue", alpha = 0.7) +
  theme_bw() +
  labs(x = "Mezcla", y = "% de vac√≠os")
```


**Boxplot por bloque dentro de mezcla**


```{r}
ggplot(datos_obj1_raw, aes(x = bloque_n, y = gbs_percent_vacios_7_1)) +
  geom_boxplot(fill = "darkorange", alpha = 0.7) +
  theme_bw() +
  labs(x = "Bloque", y = "% de vac√≠os") +
  facet_wrap(~ mezcla_n, scales = "free_x")
```



**Histograma + densidad**


```{r}
ggplot(datos_obj1_raw, aes(x = gbs_percent_vacios_7_1)) +
  geom_histogram(aes(y = ..density..), bins = 20, fill = "gray70", color = "black") +
  geom_density(color = "red", linewidth = 1) +
  theme_bw() +
  labs(x = "% de vac√≠os", y = "Densidad")
```


**Q‚ÄìQ plot**


```{r}
ggplot(datos_obj1_raw, aes(sample = gbs_percent_vacios_7_1)) +
  stat_qq() +
  stat_qq_line(color = "red") +
  theme_bw() +
  labs(x = "Cuantiles te√≥ricos", y = "Cuantiles muestrales")
```


El an√°lisis inicial del porcentaje de vac√≠os en los bloques y vigas revela una distribuci√≥n centrada entre valores de 6% y 7%, con una mediana cercana a 6.8% y un rango general que oscila entre aproximadamente 5.3% y 12.3%. Estas cifras sugieren que, aunque la mayor√≠a de las observaciones se encuentran dentro de valores habituales para mezclas asf√°lticas densas, existen algunos casos puntuales con porcentajes de vac√≠os notablemente m√°s altos, lo cual ya anticipa que no todas las mezclas o bloques presentan un comportamiento homog√©neo.

Los boxplots por mezcla muestran diferencias claras entre dise√±os. Algunas mezclas exhiben valores mucho m√°s altos y dispersos, especialmente las mezclas 1, 2 y 3, mientras que en la mayor√≠a de los dise√±os el % de vac√≠os se mantiene relativamente estable alrededor del 6.5%‚Äì7.0%. Esto indica que el dise√±o de mezcla tiene un rol importante en la variabilidad global, pues se observan patrones consistentes dentro de mezcla pero diferenciados entre mezclas. Por otra parte, los boxplots de bloques dentro de mezcla revelan que, aunque existe cierta variaci√≥n entre los bloques A y B, esta es significativamente menor que la variaci√≥n atribuible a la mezcla. Esto sugiere que el proceso de compactaci√≥n introduce variabilidad, pero su magnitud es m√°s acotada en comparaci√≥n con las diferencias entre dise√±os.

El histograma y la curva de densidad refuerzan esta interpretaci√≥n: la distribuci√≥n general del % de vac√≠os presenta asimetr√≠a hacia la derecha, con un tramo principal concentrado en el rango de 6‚Äì8% y una cola que se extiende hacia valores mayores. El gr√°fico Q‚ÄìQ confirma esta ligera desviaci√≥n respecto a la normalidad, especialmente en la cola superior, que corresponde a las mezclas con valores de vac√≠os m√°s elevados. No obstante, la mayor parte de los datos sigue una tendencia aproximadamente normal, lo cual es adecuado para proceder con modelos lineales y mixtos, siempre que se revisen los residuos posteriormente.

En conjunto, estos resultados preliminares sugieren que la mayor parte de la variaci√≥n visible en el % de vac√≠os parece estar asociada al dise√±o de mezcla, mientras que bloques y vigas muestran variabilidad m√°s contenida. La exploraci√≥n inicial tambi√©n evidencia que el comportamiento general es estable y sin valores at√≠picos extremos que comprometan el ajuste de los modelos posteriores, aunque la asimetr√≠a observada en ciertos dise√±os deber√° ser tenida en cuenta al interpretar los componentes de varianza y la regresi√≥n volum√©trica.

### 3.2 Modelo mixto para la variabilidad del % de vac√≠os

El siguiente paso del an√°lisis del Objetivo 1 consiste en cuantificar de d√≥nde proviene la variabilidad observada en el porcentaje de vac√≠os. En particular, se desea descomponer la variaci√≥n total en cuatro componentes: el efecto del **dise√±o de mezcla**, el efecto del **bloque compactado**, el efecto de la **viga obtenida por corte** y la variabilidad residual asociada al proceso de medici√≥n. Para ello se utiliza un **modelo mixto jer√°rquico** (o modelo lineal mixto con estructura anidada), que combina efectos fijos y aleatorios respetando la jerarqu√≠a Mezcla ‚Üí Bloque ‚Üí Viga.

En este contexto, la mezcla se considera un **efecto fijo**, porque corresponde a dise√±os espec√≠ficos que se quieren comparar expl√≠citamente. Por otro lado, los bloques y las vigas se tratan como **efectos aleatorios**: representan realizaciones del proceso de compactaci√≥n y del proceso de corte/operario dentro de cada mezcla, y su inter√©s principal radica en la variabilidad que introducen y no en el valor puntual de cada bloque o viga.

El modelo adoptado para el porcentaje de vac√≠os se escribe como:

\[
\text{Vac√≠os}_{ijk}
= \mu + \alpha_i + b_{j(i)} + c_{k(ij)} + \varepsilon_{ijk},
\]

donde

\[
\mu = \text{media global},
\]
\[
\alpha_i = \text{efecto fijo de la mezcla } i,
\]
\[
b_{j(i)} = \text{efecto aleatorio del bloque } j \text{ dentro de la mezcla } i,
\]
\[
c_{k(ij)} = \text{efecto aleatorio de la viga } k \text{ dentro del bloque } j \text{ y mezcla } i,
\]
\[
\varepsilon_{ijk} = \text{t√©rmino de error residual}.
\]

En t√©rminos pr√°cticos, el objetivo de este modelo es obtener, por un lado, la **prueba de significancia del efecto fijo de la mezcla** (mediante la tabla ANOVA del modelo), y por otro, los **componentes de varianza** asociados a bloques, vigas y residuo, expresados tambi√©n como porcentaje de la variaci√≥n total. Finalmente, se evaluar√°n los supuestos del modelo mediante gr√°ficos de diagn√≥stico (residuos frente a valores ajustados y gr√°fico Q‚ÄìQ de los residuos), para verificar que la aproximaci√≥n lineal mixta resulta razonable para estos datos.


**Tabla ANOVA del efecto fijo (Mezcla)**

	Se intent√≥ especificar un modelo con tres niveles (mezcla, bloque, viga), pero el nivel de ‚Äúviga dentro de bloque‚Äù dispon√≠a de una √∫nica observaci√≥n por unidad, por lo que su componente de varianza no es identificable y se confunde con el t√©rmino de error residual.

	‚Ä¢	Por esa raz√≥n, el modelo final considera:
	‚Ä¢	Mezcla como efecto fijo.
	‚Ä¢	Bloque anidado en mezcla como efecto aleatorio.
	‚Ä¢	La variabilidad entre vigas se incorpora en el error residual.

```{r}
### Ajuste del modelo mixto jer√°rquico

### Ajuste del modelo mixto jer√°rquico (sin nivel de viga)

datos_obj1_raw <- datos_obj1_raw |>
  mutate(
    mezcla_n = factor(mezcla_n),
    bloque_n = factor(bloque_n)
  )
```

```{r}
# Modelo mixto:
# Vac√≠os ~ Mezcla (fijo) + Bloque y Viga anidados como aleatorios
mod_vacios <- lmer(
  gbs_percent_vacios_7_1 ~ mezcla_n +
    (1 | mezcla_n / bloque_n),   # mezcla fija, bloque aleatorio anidado
  data = datos_obj1_raw
)
```


```{r}
anova_mod <- anova(mod_vacios, type = 3)
anova_mod
```


**Componentes de varianza (porcentaje de contribuci√≥n)**

```{r}
vc <- as.data.frame(VarCorr(mod_vacios))
vc

# calcular aporte porcentual de cada componente
vc <- vc |>
  mutate(
    fuente = grp,
    prop   = vcov / sum(vcov) * 100
  )

vc[, c("fuente", "vcov", "prop")]
```


**Gr√°ficos de diagn√≥stico: residuos vs ajustados**

```{r}
## 3.1 Residuos vs valores ajustados
diag_df <- datos_obj1_raw |>
  mutate(
    ajustados = fitted(mod_vacios),
    residuos  = resid(mod_vacios)
  )

ggplot(diag_df, aes(x = ajustados, y = residuos)) +
  geom_point(alpha = 0.7) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_bw() +
  labs(x = "Valores ajustados", y = "Residuos",
       title = "Residuos vs valores ajustados")

```


**Gr√°ficos de diagn√≥stico: Normalidad de residuos**

```{r}
ggplot(diag_df, aes(sample = residuos)) +
  stat_qq() +
  stat_qq_line(color = "red") +
  theme_bw() +
  labs(x = "Cuantiles te√≥ricos", y = "Cuantiles muestrales",
       title = "Q‚ÄìQ plot de los residuos del modelo mixto")
```


Los resultados del modelo mixto jer√°rquico permiten evaluar la contribuci√≥n relativa de cada nivel del proceso experimental a la variabilidad observada en el porcentaje de vac√≠os. El an√°lisis ANOVA sobre el efecto fijo de la mezcla muestra que el factor Mezcla no resulta estad√≠sticamente significativo para explicar diferencias en % de vac√≠os (p = 0.34). Este hallazgo sugiere que, aun cuando existen diferencias num√©ricas entre mezclas, dichas variaciones no son suficientemente grandes en relaci√≥n con la variabilidad interna del proceso como para ser detectadas como significativas.

El desglose de los componentes de varianza confirma esta interpretaci√≥n: la variabilidad total del % de vac√≠os se distribuye de manera semejante entre los tres niveles del dise√±o experimental. Aproximadamente un tercio de la variaci√≥n proviene de diferencias entre mezclas, otro tercio de diferencias entre bloques dentro de mezcla (compactaci√≥n), y el tercio restante corresponde a la variaci√≥n residual asociada a las vigas y a otras fuentes menores. Esta distribuci√≥n relativamente equilibrada indica que ning√∫n nivel domina claramente la variabilidad del proceso, lo cual es coherente con un sistema de producci√≥n relativamente estable donde mezcla, compactaci√≥n y corte influyen de manera comparable.

Las verificaciones de diagn√≥stico (residuos vs. ajustados y Q‚ÄìQ plot) muestran un comportamiento razonable para un modelo de este tipo, sin patrones que invaliden su uso, aunque con ligeras desviaciones de normalidad atribuibles a algunos valores altos de % de vac√≠os ya identificados en la exploraci√≥n inicial.

En conjunto, estos resultados revelan que la variabilidad entre mezclas no es el principal determinante del % de vac√≠os. Esto refuerza la importancia de avanzar hacia el siguiente paso del Objetivo 1: ajustar un modelo de regresi√≥n que relacione el % de vac√≠os con las propiedades volum√©tricas y de gradaci√≥n de la mezcla. A diferencia del factor Mezcla, que es solo un identificador categ√≥rico, las propiedades f√≠sicas (Gmm, Gmb, VMA, VFA, polvo-asfalto, entre otras) permiten capturar la estructura real del material y explicar por qu√© ciertas vigas presentan mayores o menores valores de % de vac√≠os. Por ello, la regresi√≥n constituye una herramienta fundamental para obtener una ecuaci√≥n que describa el comportamiento del % de vac√≠os a partir de variables con significado ingenieril y no meramente categ√≥rico.


### 3.3 Regresi√≥n del % de vac√≠os vs propiedades volum√©tricas

En esta secci√≥n se busca construir una ecuaci√≥n explicativa que relacione el porcentaje de vac√≠os de aire medido en las vigas con las propiedades volum√©tricas y de gradaci√≥n de la mezcla asf√°ltica. A diferencia del modelo mixto anterior, donde la mezcla se consider√≥ como un factor categ√≥rico, aqu√≠ el inter√©s se centra en variables con significado f√≠sico directo (Gmm, Gmb, VMA, VFA, vac√≠os en la mezcla, relaci√≥n polvo/asfalto, porcentajes que pasan cada tamiz, etc.), que permitan entender c√≥mo cambia el % de vac√≠os cuando cambian las caracter√≠sticas del material.

La variable respuesta del modelo es el porcentaje de vac√≠os obtenido a partir de la prueba de Gbs:

- **Variable dependiente**: \(\text{Vac√≠os} \equiv\) `gbs_percent_vacios_7_1`.

Como variables explicativas \((X_1,\dots,X_p)\) se consideran √∫nicamente las propiedades volum√©tricas y de gradaci√≥n medidas en las mismas vigas, por ejemplo:

- `gbs_gmm`, `gbs_gmb`
- `pvm_asfalto_efectivo_percent`, `pvm_asfalto_sobre_mac_percent`
- `pvm_vacios_pv`, `pvm_gbs`
- `pvm_vma_percent`, `pvm_vfa_percent`, `pvm_polvo_asfalto`
- `pvm_percent_pasando_1_2`, `pvm_percent_pasando_number_4`,
  `pvm_percent_pasando_number_8`, `pvm_percent_pasando_number_200`.

El modelo base que se plantea es una regresi√≥n lineal m√∫ltiple del tipo:

\[
\widehat{\text{Vac√≠os}}_i
= \beta_0 + \beta_1 X_{1i} + \cdots + \beta_p X_{pi} + \varepsilon_i,
\]

donde \(\beta_0\) es el intercepto, \(\beta_1,\dots,\beta_p\) son los coeficientes asociados a cada propiedad volum√©trica y \(\varepsilon_i\) representa el t√©rmino de error.

El procedimiento se organiza en tres etapas:

1. Definir el conjunto de variables candidatas y evaluar la colinealidad inicial mediante la matriz de correlaci√≥n y el factor de inflaci√≥n de la varianza (VIF).  
2. Ajustar un modelo base de regresi√≥n lineal con todas las variables candidatas.  
3. Aplicar un proceso de selecci√≥n (backward/forward) apoyado en criterios estad√≠sticos y en la coherencia f√≠sica de los coeficientes, seguido de una validaci√≥n ligera mediante \(R^2\), \(R^2\) ajustado y an√°lisis de residuos.

**1. Definir variables candidatas**

```{r}
### 3.3 Regresi√≥n del % de vac√≠os vs propiedades volum√©tricas

# Variable respuesta
y <- datos_obj1_raw$gbs_percent_vacios_7_1

# Conjunto de predictores candidatos: volum√©tricas + gradaci√≥n
predictores_obj1 <- datos_obj1_raw |>
  select(
    gbs_gmm,
    gbs_gmb,
    pvm_asfalto_efectivo_percent,
    pvm_asfalto_sobre_mac_percent,
    pvm_vacios_pv,
    pvm_gbs,
    pvm_vma_percent,
    pvm_vfa_percent,
    pvm_polvo_asfalto,
    pvm_percent_pasando_1_2,
    pvm_percent_pasando_number_4,
    pvm_percent_pasando_number_8,
    pvm_percent_pasando_number_200
  )

# Data.frame completo para la regresi√≥n
datos_reg_obj1 <- bind_cols(
  vacios = y,
  predictores_obj1
)
```

**2. Evaluaci√≥n de colinealidad (correlaci√≥n + VIF) **

```{r}
# Matriz de correlaci√≥n (solo num√©ricas)
corr_reg_obj1 <- cor(predictores_obj1, use = "pairwise.complete.obs")
corrplot(corr_reg_obj1, method = "color", tl.cex = 0.7)

# Modelo "lleno" para calcular VIF
mod_full_obj1 <- lm(vacios ~ ., data = datos_reg_obj1)

# Factores de inflaci√≥n de la varianza
vif_obj1 <- car::vif(mod_full_obj1)
vif_obj1
```

**3. Ajuste del modelo base y selecci√≥n de variables**

```{r}
# Modelo base con todas las variables candidatas
mod_base_obj1 <- lm(vacios ~ ., data = datos_reg_obj1)
summary(mod_base_obj1)

# Selecci√≥n stepwise basada en AIC (backward desde el modelo lleno)
mod_step_obj1 <- step(mod_base_obj1, direction = "backward", trace = FALSE)
summary(mod_step_obj1)
```

**4. Validaci√≥n ligera del modelo seleccionado**

```{r}
# Extraer R¬≤ y R¬≤ ajustado
summary(mod_step_obj1)$r.squared
summary(mod_step_obj1)$adj.r.squared

# Diagn√≥stico de residuos
diag_reg_obj1 <- datos_reg_obj1 |>
  mutate(
    ajustados = fitted(mod_step_obj1),
    residuos  = resid(mod_step_obj1)
  )

# Residuos vs ajustados
ggplot(diag_reg_obj1, aes(x = ajustados, y = residuos)) +
  geom_point(alpha = 0.7) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_bw() +
  labs(
    x = "Valores ajustados",
    y = "Residuos",
    title = "Residuos vs valores ajustados (modelo de regresi√≥n)"
  )

# Q‚ÄìQ plot de residuos
ggplot(diag_reg_obj1, aes(sample = residuos)) +
  stat_qq() +
  stat_qq_line(colour = "red") +
  theme_bw() +
  labs(
    x = "Cuantiles te√≥ricos",
    y = "Cuantiles muestrales",
    title = "Q‚ÄìQ plot de los residuos del modelo de regresi√≥n"
  )
```




### 3.4 S√≠ntesis t√©cnica del Objetivo 1

(Sin conclusiones finales a√∫n)

Aqu√≠ solo se resume qu√© se model√≥ y por qu√©, no los resultados.

Ejemplo:
	‚Ä¢	Se evalu√≥ la variabilidad del % de vac√≠os mediante un modelo mixto jer√°rquico.
	‚Ä¢	Se ajust√≥ un modelo de regresi√≥n para identificar propiedades volum√©tricas relevantes.
	‚Ä¢	Ambos an√°lisis aportan informaci√≥n complementaria:
	‚Ä¢	uno sobre variabilidad estructural,
	‚Ä¢	el otro sobre relaciones f√≠sicas entre propiedades y vac√≠os.

(Las conclusiones van al final del documento, no aqu√≠).








## 4. Objetivo 2.  {.tabset .tabset-fade .tabset-pills}





###


```{r}

```

```{r}

```

###

```{r}

```

```{r}

```


## 5. Conclusiones.  {.tabset .tabset-fade .tabset-pills}


## REF {.tabset .tabset-fade .tabset-pills}


